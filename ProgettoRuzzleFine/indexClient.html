<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Client</title>
</head>

<body>
    <input type="text" id="nomeUtente">
    <input type="button" value="ACCEDI" onclick="accedi()">
    <input type="button" value="punto++" onclick="incrementaPunti()">


    <script>
        let clientID = null;
        let ws = new WebSocket("ws://172.22.194.128:3002");                 //impostare ogni volta indirizzo ip dispostivo server 
        let nomeUtente = null;
        let contatorePunti = 0;

        ws.onmessage = message => {
            const response = JSON.parse(message.data);
            if (response.method === "connect") {
                clientID = response.clientID;
                console.log("CLIENT ID: " + clientID + "CONNECTED");

            }
            if (response.method === "go") {
                //start della partita
                console.log("Partita iniziata!");
            }

        }

        function accedi() {
            nomeUtente = document.getElementById("nomeUtente").value;
            const payLoad = {
                "method": "accept",
                "type": "client",
                "clientID": clientID,
                "nome": nomeUtente
            }
            ws.send(JSON.stringify(payLoad));
        }

        function incrementaPunti(){
            const payLoad = {
                "method": "incPunti",
                "clientID": clientID,
                "punto": contatorePunti
            }
            ws.send(JSON.stringify(payLoad));
        }





    </script>

</body>

</html>